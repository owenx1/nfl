<h1 align="center">The Leaderboard</h1>
<p align="center">Predict often to be the best!</p>
<% @profiles = Profile.order("rank ASC")%>
<% rank = 1%>
<table align="center">
<tr>
	<td>Rank</td>
	<td>Name</td>
	<td>No. Of Correct Predictions</td>
	<td>Average margin of error</td>
</tr>
<% @profiles.each do |profile| %>
<% if Prediction.count(:success, :conditions => ['user_id = ' + profile.user_id.to_s + ' and success = 1' ]) > 0 %>
	<tr>
        <td><%= rank %></td>
		<td><%= profile.firstname %> <%= profile.lastname %> </td>
		<td align="center"><%= Prediction.count(:success, :conditions => ['user_id = ' + profile.user_id.to_s + ' and success = 1' ]) %></td>
		<td align="center"><%= Prediction.sum(:difference, :conditions => ['user_id = ' + profile.user_id.to_s ]) %></td>
      </tr>
<% rank += 1 %>
<% end %>
<% end %>
</table>